!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var s=t();for(var r in s)("object"==typeof exports?exports:e)[r]=s[r]}}(this,(()=>(()=>{"use strict";var e={d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{AjaxClient:()=>s,AjaxClient2:()=>r});class s{constructor(){}getAsync(e){e.type="get",this.ajax(e)}postAsync(e){e.type="post",this.ajax(e)}async get(e){if(e.type="get","application/json"===e.contentType)if("String"===this.typeOf(e.data));else{const t=e.data;e.data=JSON.stringify(t)}return new Promise((t=>{e.success=(e,s)=>{t({success:!0,data:e,response:s})},e.error=(e,s)=>{t({success:!1,cause:"error",error:e,response:s})},e.timeout=e=>{t({success:!1,cause:"timeout",error:e,response:null})},this.ajax(e)}))}async post(e){if(e.type="post","application/json"===e.contentType)if("String"===this.typeOf(e.data));else{const t=e.data;e.data=JSON.stringify(t)}return new Promise((t=>{e.success=e=>{t({success:!0,data:e})},e.error=e=>{t({success:!1,cause:"error",error:e})},e.timeout=e=>{t({success:!1,cause:"timeout",error:e})},this.ajax(e)}))}ajax(e){const t=new XMLHttpRequest;if(!e)throw Error("Please specify options like #ajax(options)");if(!e.url)throw Error("Please specify url.");if(e.type&&"post"===e.type.toLowerCase())t.open("POST",e.url,true);else{if(!e.type||"get"!==e.type.toLowerCase())throw Error("type:".concat(e.type," is not supported"));t.open("GET",e.url,true)}if(e.dataType&&"json"===e.dataType)t.responseType="text";else{if(!e.dataType||"text"!==e.dataType)throw Error("Please check dataType:".concat(e.dataType,'. "json" or "text"  is supported as dataType now.'));t.responseType="text"}if(e.contentType)try{t.setRequestHeader("Content-Type",e.contentType)}catch(t){throw Error("Invalid content type ".concat(e.contentType))}else if(e.type&&"post"===e.type.toLowerCase()||e.type&&"put"===e.type.toLowerCase())throw Error("Please specify contentType.");if(e.headers)for(const s in e.headers){const r=e.headers[s];t.setRequestHeader(s,r)}if(e.xhrFields){const{xhrFields:s}=e;!0===s.withCredentials&&(t.withCredentials=!0)}if(e.timeoutMillis&&(t.timeout=e.timeoutMillis),t.onload=s=>{if(200==t.status){let s="";s="json"==e.dataType?JSON.parse(t.response):t.response,e.success&&e.success(s,t)}else e.error&&e.error(s,t)},e.timeout&&(t.ontimeout=s=>{e.timeout(s,t)}),e.error&&(t.onerror=s=>{e.error(s,t)}),e.type&&"post"===e.type.toLowerCase()){if(!e.data)throw Error('.data is not specified.data must be specified on "POST" mode.');if(e.contentType.startsWith("application/x-www-form-urlencoded")){const s=e=>{const t=[];for(const s in e){const r=e[s],o=encodeURIComponent(s)+"="+encodeURIComponent(r);t.push(o)}return t.join("&").replace(/%20/g,"+")},r=s(e.data);t.send(r)}else t.send(e.data)}else e.type&&"get"===e.type.toLowerCase()&&t.send(null)}typeOf(e){return Object.prototype.toString.call(e).slice(8,-1)}}class r{constructor(e){this.opt=e||{}}getAsync(e){e.type="get",this.ajax(e)}postAsync(e){e.type="post",this.ajax(e)}async get(e){if(e.type="get","application/json"===e.contentType)if("String"===this.typeOf(e.data));else{const t=e.data;e.data=JSON.stringify(t)}return new Promise((t=>{e.success=(e,s)=>{t({success:!0,data:e,response:s})},e.error=(e,s,r,o)=>{t({success:!1,data:e,cause:r,error:o,response:s})},e.timeout=(e,s,r,o)=>{t({success:!1,data:e,cause:r,error:o,response:s})},this.ajax(e)}))}async post(e){if(e.type="post","application/json"===e.contentType)if("String"===this.typeOf(e.data));else{const t=e.data;e.data=JSON.stringify(t)}return new Promise((t=>{e.success=(e,s)=>{t({success:!0,data:e,response:s})},e.error=(e,s,r,o)=>{t({success:!1,data:e,cause:r,error:o,response:s})},e.timeout=(e,s,r,o)=>{t({success:!1,data:e,cause:r,error:o,response:s})},this.ajax(e)}))}ajax(e){const t=this._createUrl(e),s=e.type,r=e.dataType,o=e.data,n=e.headers,a=e.contentType;let c=null;if(!t)throw Error("Please specify url.");if(s&&"post"===s.toLowerCase()&&(c=o,"jsonp"===r))throw new Error("type:'POST' and 'dataType:jsonp' are specified together.\n                'POST' and 'jsonp' can not be specified together");if(n&&"jsonp"===r)throw new Error("'headers' and 'dataType:jsonp' can not be specified together.\n           Http headers cannot be sent when using jsonp.");const i={url:t,method:s,body:c,contentType:a};if(n&&(i.headers=n),"json"===r||"text"===r){return this._handleData(i,r,e)}if("jsonp"===r){return this._handleJsonp(i,e)}throw new Error("Please check dataType:".concat(r," dataType must be 'json' or 'jsonp'"))}_getFetchParam(e,t){const s=e.method.toUpperCase(),r={method:s,mode:"cors",cache:"no-cache",headers:{}};if(e.contentType)r.headers["Content-Type"]=e.contentType;else if("POST"===s||"PUT"===s)throw Error("Please specify contentType.");if(t.xhrFields){const{xhrFields:e}=t;!0===e.withCredentials&&(r.credentials="include")}if(e.credentials&&(r.credentials=e.credentials),e.headers)for(const t in e.headers){const s=e.headers[t];r.headers[t]=s}if(e.body)if(e.contentType.startsWith("application/x-www-form-urlencoded")){const t=e=>{const t=[];for(const s in e){const r=e[s],o=encodeURIComponent(s)+"="+encodeURIComponent(r);t.push(o)}return t.join("&").replace(/%20/g,"+")},s=t(e.body);r.body=s}else r.body=e.body;return r}_handleData(e,t,s){const r=new o,n=this._getFetchParam(e,s);return((e,s)=>new Promise(((r,o)=>{s&&s.timeoutMillis&&setTimeout((()=>{o({data:null,cause:"timeout,".concat(s.timeoutMillis,"ms elapsed"),response:null})}),s.timeoutMillis),e.then((e=>{e.ok?"json"===t?e.json().then((t=>{r({data:t,response:e})})).catch((t=>{o({data:null,cause:"client error,".concat(t),response:e})})):"text"===t&&e.text().then((t=>{r({data:t,response:e})})).catch((t=>{o({data:null,cause:"client error,".concat(t),response:e})})):"json"===t?e.json().then((t=>{o({data:t,cause:"server error,statusCode:".concat(e.status),response:e})})).catch((t=>{e.text().then((t=>{o({data:t,cause:"server error,statusCode:".concat(e.status),response:e})})).catch((t=>{o({data:null,cause:"client error,".concat(t),response:e})}))})):"text"===t&&e.text().then((t=>{o({data:t,cause:"server error,statusCode:".concat(e.status),response:e})})).catch((t=>{o({data:null,cause:"client error,".concat(t),response:e})}))})).catch((e=>{o({data:null,cause:"network error",response:null,err:e})}))})))((this.opt.fetch||fetch)(e.url,n),s).then((e=>{r._success(e),s&&s.success&&s.success(e.data,e.response)})).catch((e=>{r._fail(e),"timeout"===e.cause?s&&s.timeout&&s.timeout(e.data,e.response,e.cause,e.err):s&&s.error&&s.error(e.data,e.response,e.cause,e.err)})),r}_handleJsonp(e,t){const s=new o,r=document.createElement("script"),n="ajaxclient2_".concat(this._createUUID());let a=e.url;a.indexOf("?")>=0?a+="&callback=".concat(n):a+="?callback=".concat(n),r.src=a,r.addEventListener("error",(e=>{s._fail(e),t&&t.error&&t.error(e,null)})),window[n]=e=>{delete window[n],s._success({data:e,response:null}),t&&t.success&&t.success(e,null)};return(document.getElementsByTagName("head")?document.getElementsByTagName("head")[0]:document.body).appendChild(r),s}_createUrl(e){if(e.type&&"post"===e.type.toLowerCase())return e.url;if(e.type&&"get"===e.type.toLowerCase()){let t=e.url;if(e.data){const s=JSON.parse(e.data);t+="?";for(let e of Object.keys(s)){const r=s[e];t+="".concat(e,"=").concat(r,"&")}t=t.substring(0,t.length-1)}return t}throw Error("Invalid type ".concat(e.type," is not supported"))}_createUUID(){const e=(new Date).getTime();return"xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const s=(e+16*Math.random())%16|0;return("x"==t?s:3&s|8).toString(16)}))}typeOf(e){return Object.prototype.toString.call(e).slice(8,-1)}}class o{constructor(){this._successFunc=()=>{},this._failFunc=()=>{}}done(e){return this._successFunc=e,this}fail(e){return this._failFunc=e,this}_success(e){this._successFunc&&this._successFunc(e.data,e.response)}_fail(e){this._failFunc&&this._failFunc(e.data,e.response,e.cause,e.err)}}return t})()));